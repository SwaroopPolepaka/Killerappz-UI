<div class="animated fadeIn">
  <div class="row">
    <div class="col-md-9">
      <div class="card">
        <div class="card-body">
          <div class="row">
            <div class="col-sm-6">
              <h4 class="card-title mb-0">Traffic</h4>
              <div class="small text-muted">January 2018</div>
            </div>
            <div class="col-sm-6">
              <button type="button" class="btn btn-success float-right">
                <i class="icon-cloud-download"></i>
              </button>
              <div class="btn-toolbar float-right" role="toolbar" aria-label="Toolbar with button groups">
                <div class="btn-group mr-3" data-toggle="buttons" aria-label="First group">
                  <label class="btn btn-outline-secondary">
                    <input type="radio" name="options" id="option1"> Day
                  </label>
                  <label class="btn btn-outline-secondary active">
                    <input type="radio" name="options" id="option2" checked> Month
                  </label>
                  <label class="btn btn-outline-secondary">
                    <input type="radio" name="options" id="option3"> Year
                  </label>
                </div>
              </div>
            </div>
          </div>
          <div class="chart-wrapper" style="height:306px;margin-top:40px;">
            <canvas baseChart class="chart" [datasets]="mainChartData" [labels]="mainChartLabels" [options]="mainChartOptions" [colors]="mainChartColours"
              [legend]="mainChartLegend" [chartType]="mainChartType" (chartHover)="chartHovered($event)" (chartClick)="chartClicked($event)"></canvas>
          </div>
        </div>
        <div class="card-footer">
          <ul>
            <li>
              <div class="text-muted">Visits</div>
              <strong>29.703 Users (40%)</strong>
              <div class="progress progress-xs mt-2">
                <div class="progress-bar bg-success" role="progressbar" style="width: 40%" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
            </li>
            <li class="hidden-sm-down">
              <div class="text-muted">Unique</div>
              <strong>24.093 Users (20%)</strong>
              <div class="progress progress-xs mt-2">
                <div class="progress-bar bg-info" role="progressbar" style="width: 20%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
            </li>
            <li>
              <div class="text-muted">Pageviews</div>
              <strong>78.706 Views (60%)</strong>
              <div class="progress progress-xs mt-2">
                <div class="progress-bar bg-warning" role="progressbar" style="width: 60%" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
            </li>
            <li class="hidden-sm-down">
              <div class="text-muted">New Users</div>
              <strong>22.123 Users (80%)</strong>
              <div class="progress progress-xs mt-2">
                <div class="progress-bar bg-danger" role="progressbar" style="width: 80%" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
            </li>
            <li class="hidden-sm-down">
              <div class="text-muted">Bounce Rate</div>
              <strong>40.15%</strong>
              <div class="progress progress-xs mt-2">
                <div class="progress-bar" role="progressbar" style="width: 40%" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-white bg-primary">
        <div class="card-body pb-0">
          <div class="btn-group float-right" dropdown placement="bottom right">
            <button type="button" class="btn btn-transparent dropdown-toggle p-0" dropdownToggle>
              <i class="icon-settings"></i>
            </button>
            <div class="dropdown-menu dropdown-menu-right" *dropdownMenu>
              <a class="dropdown-item" href="#">Action</a>
              <a class="dropdown-item" href="#">Another action</a>
              <a class="dropdown-item" href="#">Something else here</a>
            </div>
          </div>
          <h4 class="mb-0">9.823</h4>
          <p>Alerts</p>
        </div>
        <div class="chart-wrapper px-3" style="height:70px;">
          <canvas baseChart class="chart" [datasets]="lineChart1Data" [labels]="lineChart1Labels" [options]="lineChart1Options" [colors]="lineChart1Colours"
            [legend]="lineChart1Legend" [chartType]="lineChart1Type" (chartHover)="chartHovered($event)" (chartClick)="chartClicked($event)"></canvas>
        </div>
      </div>
      <div class="card text-white bg-warning">
        <div class="card-body pb-0">
          <div class="btn-group float-right" dropdown placement="bottom right">
            <button type="button" class="btn btn-transparent dropdown-toggle p-0" dropdownToggle>
              <i class="icon-settings"></i>
            </button>
            <div class="dropdown-menu dropdown-menu-right" *dropdownMenu>
              <a class="dropdown-item" href="#">Action</a>
              <a class="dropdown-item" href="#">Another action</a>
              <a class="dropdown-item" href="#">Something else here</a>
            </div>
          </div>
          <h4 class="mb-0">9.823</h4>
          <p>Tickets Created</p>
        </div>
        <div class="chart-wrapper" style="height:70px;">
          <canvas baseChart class="chart" [datasets]="lineChart3Data" [labels]="lineChart3Labels" [options]="lineChart3Options" [colors]="lineChart3Colours"
            [legend]="lineChart3Legend" [chartType]="lineChart3Type" (chartHover)="chartHovered($event)" (chartClick)="chartClicked($event)"></canvas>
        </div>
      </div>
      <div class="card text-white bg-danger">
        <div class="card-body pb-0">
          <div class="btn-group float-right" dropdown placement="bottom right">
            <button type="button" class="btn btn-transparent dropdown-toggle p-0" dropdownToggle>
              <i class="icon-settings"></i>
            </button>
            <div class="dropdown-menu dropdown-menu-right" *dropdownMenu>
              <a class="dropdown-item" href="#">Action</a>
              <a class="dropdown-item" href="#">Another action</a>
              <a class="dropdown-item" href="#">Something else here</a>
            </div>
          </div>
          <h4 class="mb-0">9.823</h4>
          <p>Attack Vector</p>
        </div>
        <div class="chart-wrapper px-3" style="height:70px;">
          <canvas baseChart class="chart" [datasets]="barChart1Data" [labels]="barChart1Labels" [options]="barChart1Options" [colors]="barChart1Colours"
            [legend]="barChart1Legend" [chartType]="barChart1Type" (chartHover)="chartHovered($event)" (chartClick)="chartClicked($event)"></canvas>
        </div>
      </div>
    </div>
  </div>
  <!--/.row-->

  <div class="row">
    <div class="col-md-12">
      <div class="card">
        <div class="card-header">
          <h4 class="card-title mb-0">Nexpose</h4>
        </div>
        <div *ngIf="stats== null" class="card-body">
          No data available
        </div>
        <div *ngIf="stats!== null" class="card-body">
          <div class="row">
            <div class="col-sm-10 col-lg-4">
              <div class="row">
                <div class="col-sm-6">
                  <div class="callout callout-info">
                    <small class="text-muted">High Risk Site</small>
                    <br>
                    <strong class="h4">{{stats.highestRiskSite}}</strong>

                  </div>
                </div>
                <!--/.col-->
                <div class="col-sm-6">
                  <div class="callout callout-danger">
                    <small class="text-muted">Unsafe Vulnerabilities </small>
                    <br>
                    {{stats.unsafeVulnerabilities}}/{{stats.totalVulnerabilities}}

                  </div>
                </div>
                <!--/.col-->
              </div>
              <!--/.row-->
              <hr class="mt-0">
              <table class="table horizontal-bars" style="width:100%; ">
                <tr *ngFor="let site of stats.sites">
                  <td>
                    <div class="row"style="padding-bottom = 5px" >
                      <div class="col">{{site.name}} </div>
                      <div class="col"></div>
                      <div class="col" style="
                      text-align: right;"><span class="text-muted" >{{site.riskFactor}}</span>|{{site.riskScore}}</div>
                    </div>

                    <div class=" bars">
                      <div class="progress progress-xs">
                        <div class="progress-bar bg-info" role="progressbar" style="width: 90%" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"></div>
                      </div>
                    </div>
                  <div class="pull-right text-muted" style="font-size:  10px;">
                    Scanned 4 hours ago
                  </div>
                  </td>
                </tr>
              </table>
            </div>
            <!--/.col-->
            <div class="col-sm-6 col-lg-4">
              <div class="row">
                <div class="col-sm-8">
                  <div class="callout callout-warning">
                    <strong class="h4">Top Vulnerabilities</strong>
                    <br>
                    <small class="text-muted">
                      <a href="#" (click)="cvss=true;security =false">CvssScore</a>/
                      <a href="#" (click)="cvss=false;security =true">Severity</a>
                    </small>
                  </div>
                </div>
                <!--/.col-->
              </div>
              <!--/.row-->
              <hr class="mt-0">
              <table>
                <div *ngIf="cvss">
                    <tr *ngFor="let cvss of stats.vulnerabilitiesByCvssScore | paginate: { id: '123', itemsPerPage: 7, currentPage: p };">
                      <td>
                      <span style="
                  font-size: 12px;" class="value">{{cvss.title}}</span>
                      <br>
                      <span  class="text-muted small pull-right">CVSS score:{{cvss.cvssScore}}|
                        <span  class="text-muted small pull-right">severity:{{cvss.severity}}</span>
                      </span>
                    </td>
                    </tr>
                  <pagination-controls id="123" maxSize="7" (pageChange)="p = $event"></pagination-controls>

                </div>
                <div *ngIf="security">
                    <tr *ngFor="let cvss of stats.vulnerabilitiesBySeverity | paginate: { id: '122',itemsPerPage: 7, currentPage: p };">
                      <td>
                      <span style="
                  font-size: 12px;" class="value">{{cvss.title}}</span>
                      <br>
                      <span style="
                  text-align: right" class="text-muted pull-right small">cvssScore:{{cvss.cvssScore}} |
                        <span style="
                  text-align: right" class="text-muted pull-right small">severity:{{cvss.severity}}</span>
                      </span>
                    </td>
                    </tr>
                  <pagination-controls id="122" maxSize="7" (pageChange)="p = $event"></pagination-controls>

                </div>
              </table>

            </div>
            <!--/.col-->
            <div class="col-sm-6 col-lg-4">
              <div class="row">

                <div class="col-sm-6">
                  <div class="callout callout-primary">
                    <strong class="h4">Events &<br> Nofications</strong>
                  </div>
                </div>
              </div>
              <!--/.row-->
              <hr class="mt-0">
              <ul class="icons-list">
                <li>
                  <div class="desc">
                    <div class="title">Site 4 - Service Now ticket created</div>
                    <small>Ticket 23119 - Critical Vulnerability, Firewall....</small>
                  </div>
                  <div class="value">
                    <div class="small text-muted">2018-01-27 19:35:26.000 </div>
                  </div>
                </li>
                <li>
                  <div class="desc">
                    <div class="title">Site 4 - New Vulnerability Report Available</div>
                    <small>New Report Available.</small>
                  </div>
                  <div class="value">
                    <div class="small text-muted">2018-01-27 19:30:26.000 </div>
                  </div>
                </li>
                <li>
                  <div class="desc">
                    <div class="title">Site 4 - New Vulnerabilities Found</div>
                    <small>7 Critical, 10 Major, 200 Minor....</small>
                  </div>
                  <div class="value">
                    <div class="small text-muted">2018-01-27 19:25:26.000 </div>
                  </div>
                </li>
                <li>
                  <div class="desc">
                    <div class="title">Site 2 - Scan Failure</div>
                    <small>Cannot Scan Site 2....</small>
                  </div>
                  <div class="value">
                    <div class="small text-muted">2018-01-27 19:22:26.000</div>
                  </div>
                </li>
                <li>
                  <div class="desc">
                    <div class="title">Site 3 - Site Scan Failure</div>
                    <small>Cannot Scan Site 3....</small>
                  </div>
                  <div class="value">
                    <div class="small text-muted">2018-01-27 19:20:26.000 </div>
                  </div>
                </li>
                <li>
                  <div class="desc">
                    <div class="title">Site 5 - Scan Complete.</div>
                    <small>No new Vulnerabilities Found for Site 5.</small>
                  </div>
                  <div class="value">
                    <div class="small text-muted">2018-01-27 19:20:26.000</div>
                  </div>
                </li>
                <li>
                  <div class="desc">
                    <div class="title">Site 1 - JIRA Ticket Created</div>
                    <small>Ticket IT-119 - Critical Vulnerability, Firewall....</small>
                  </div>
                  <div class="value">
                    <div class="small text-muted">2018-01-27 19:20:26.000 </div>
                  </div>
                </li>
                <li class="divider text-center">
                  <button type="button" class="btn btn-sm btn-link text-muted" data-toggle="tooltip" data-placement="top" title="show more">
                    <i class="icon-options"></i>
                  </button>
                </li>
              </ul>
            </div>
          </div>
          <br>
          <div class="table-responsive-sm"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <div class="card">
        <div class="card-header">
          <h4 class="card-title mb-0">Syslog</h4>
        </div>
        <div class="card-body">

          <table class="table table-responsive-sm table-hover table-outline mb-0">
            <thead class="thead-light">
              <tr>
                <th class="text-center">Timestamp</th>
                <th class="text-center">Level</th>
                <th class="text-center">Message</th>
                <th class="text-center">Source</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-center">
                  <div>
                    2018-01-27 19:20:26.000
                  </div>
                </td>
                <td class="text-center">
                  <div>6</div>
                </td>
                <td class="text-left">
                  <div>Secret Sauce --- sending udp query: #1</div>
                </td>
                <td class="text-center">
                  <div>8.8.8.8:53</div>
                </td>
              </tr>
              <tr>
                <td class="text-center">
                  <div>
                    2018-01-27 19:20:26.000
                  </div>
                </td>
                <td class="text-center">
                  <div>6</div>
                </td>
                <td class="text-left">
                  <div>Secret Sauce local query: #1</div>
                </td>
                <td class="text-center">
                  <div>8.8.8.8:53</div>
                </td>
              </tr>
              <tr>
                <td class="text-center">
                  <div>
                    2018-01-27 19:20:26.000
                  </div>
                </td>
                <td class="text-center">
                  <div>6</div>
                </td>
                <td class="text-left">
                  <div>Secret Sauce --- sending udp query: #1</div>
                </td>
                <td class="text-center">
                  <div>8.8.8.8:53</div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>